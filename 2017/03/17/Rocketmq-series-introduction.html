

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rocketmq系列-概念</title>
    
    <meta name="author" content="Youly">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Youly</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/archive">存档</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories">分类</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages">页面</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags">标签</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  




            <!--
            <li><a href="/resume">简历</a></li>
            -->
            <li><a href="/photos">相册</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        

<div class="page-header">
  <h1>Rocketmq系列-概念 </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>17 March 2017</span>
    </div>
    <div class="content">
      <h3 id="rocketmq-">rocketmq 核心概念</h3>

<blockquote>
  <p>Apache RocketMQ™ is an open source distributed messaging and streaming data platform.</p>
</blockquote>

<p>RocketMQ 是阿里开源的分布式消息系统，提供低延时、高可靠的消息发布与订阅服务。下图来自其官网介绍：</p>

<p><img src="/assets/images/rmq-model.png" alt="rocketmq 模型" /></p>

<p>1、message：信息的载体，rocketmq 里的消息包含 body，tag， properties。</p>

<p>2、topic: 生产者往其中投递消息，消费者从中消费消息，生产与消费必须指定topic。</p>

<p>3、group：一个消息的 topic 可以被多个组的生产者(producer group)生产，也可以被多个组的消费者(consumer group)消费。</p>

<p>4、queue：topic 的内部组成，存储消息的最小单元。一个 topic 通常有一个或者多个内部 queue。</p>

<p>5、offset：消息在 queue 里的偏移量。消费者消费消息时，broker会存储消费者的消费偏移量。</p>

<h3 id="rocketmq--1">rocketmq 部署模型</h3>

<h4 id="section">物理部署结构</h4>

<p><img src="/assets/images/rmq-deployment-model.png" alt="rocketmq 物理模型" /></p>

<p>1、NameServer集群：提供topic的路由信息，比如生产者发布消息前，可以从 nameserver 查询消息应该被发往哪个 broker。nameserver是无状态的，集群节点之间互不通信。</p>

<p>2、broker集群：从生产者接收消息并存储，后续消费者从这里消费消息。broker 分为 Master 与 Slave，一个 Master 可以对应多个 Slave，一个 Slave 只能对应一个 Master。broker 启动后，会定时将 topic 信息注册到所有的 nameserver。</p>

<p>3、producer集群：生产集群，与 nameserver 中的一台建立长连接，定时拉取 topic 信息。</p>

<p>4、consumer集群：消费集群，与 nameserver 中的一台建立长连接，定时拉取 topic 信息。</p>

<h3 id="rocketmq--2">rocketmq 提供了哪些亮点功能？</h3>

<p>1、消息堆积，容量依磁盘大小而定</p>

<p>2、消息延迟发送，提供了固定的几个间隔的延迟时间设置</p>

<p>3、消息过滤，基于tag</p>

<p>4、消息的可靠存储</p>

<h3 id="section-1">参考</h3>

<p>1、<a href="http://alibaba.github.io/RocketMQ-docs/document/design/RocketMQ_design.pdf">RocketMQ 原理简介</a></p>

<p>2、<a href="http://www.jianshu.com/p/453c6e7ff81c">分布式开放消息系统(RocketMQ)的原理与实践</a></p>

<p>3、<a href="https://kgyhkgyh.gitbooks.io/rocketmq/content/index.html">Gitbook: RocketMQ原理详解</a></p>

<p>3、<a href="https://rocketmq.incubator.apache.org/docs/core-concept/">RocketMQ core concept</a></p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#java-ref">
    		java <span>5</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#java-ref">java <span>8</span></a></li>
     
    	<li><a href="/tags.html#rocketmq-ref">rocketmq <span>1</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2017/02/12/java-object-copy" title="java对象拷贝">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/2017/06/06/counter-service-design-in-content-based-community" title="内容社区产品中的计数服务设计">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
<script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
<script>
var cloudTieConfig = {
      url: document.location.href, 
        sourceId: "",
          productKey: "0fd00f73d0a349de8d748338ffe413a0",
            target: "cloud-tie-wrapper"
};
var yunManualLoad = true;
Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);
</script>





  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2017 Youly
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    

  </body>
</html>

